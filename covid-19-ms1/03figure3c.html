<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="content-type" content="text/html; charset=utf8"/>
    <title>NU SCRIPT COVID-19</title>
    <style type="text/css">
        html {
          margin: 0; padding: 0;
          font-size: 20px; font-family: Helvetica, Verdana, sans-serif;
        }
        body {margin: 0; padding: 20px 100px;}
        a {color: #1385cb}
        a:visited {color: #0e74bc}
        .header {margin-bottom: 10px;}
        .header h2, .header h3 {font-weight: normal; text-align: center; margin: 0 0 6px 0;}
      </style>
    <link rel="stylesheet" href="https://software.broadinstitute.org/morpheus/css/morpheus-latest.min.css">
    <script>if (typeof module === 'object') {
    window.module = module;
    module = undefined;

    }</script>

    <script type="text/javascript" src="https://software.broadinstitute.org/morpheus/js/morpheus-external-latest.min.js"></script>
    <script src="https://software.broadinstitute.org/morpheus/js/morpheus-latest.min.js"></script>
</head>
<body>
    <div class="header">
        <h2>Figure 3c. k-means clustering of the 1,129 most variable genes across diagnoses</h2>
    </div>
    <div id="morpheus-container" style="width: 1200px; height: 800px;"></div>

    <script type="text/javascript">
        new morpheus.HeatMap({
            el: document.querySelector('#morpheus-container'),
            name: "Figure 3c.",
            dataset: "03figure3c-expr.tsv",
            rows: [
                {field: "gene_name", display: ["text"]},
                {field: "cluster", display: ["text", "color"], formatter: "d"}
            ],
            columns: [
                {field: "id", display: ["text"]},
                {field: "Day of intubation", display: ["color"]},
                {field: "Superinfection", display: ["color"]},
                {field: "Diagnosis", display: ["color"]}
            ],
            columnColorModel: {
                "Diagnosis": {
                    "Non-Pneumonia Control": "#4DBBD5",
                    "COVID-19": "#E64B35",
                    "Other Viral Pneumonia": "#00A087",
                    "Other Pneumonia": "#3C5488",
                    "Healthy Control": "#8491B4"
                },
                "Superinfection": {
                    "Primary Only": "#A1C9B4",
                    "Superinfection": "#6C5B47",
                    "NA": "#FFFFFF"
                },
                "Day of intubation": {
                    "values": [0, 90],
                    "colors": ["#9b98c5", "#3d287a"]
                }
            },
            rowColorModel: {
                "cluster": {
                    "values": [1, 2, 3, 4, 5],
                    "colors": ["#1e76b3", "#ff7e0d", "#2b9f2b", "#d52627", "#9366bc"]
                }
            },
            columnAnnotations: [{
                file: "03figure3c-col-meta.tsv",
                datasetField: "id",
                fileField: "id"
            }],
            rowAnnotations: [{
                file: "03figure3c-row-meta.tsv",
                datasetField: "id",
                fileField: "gene"
            }],
            colorScheme: { // optional color scheme. default is relative
                type: 'fixed',
                map: [{
                    value: -2,
                    color: '#0000ff'
                }, {
                    value: 0,
                    color: '#ffffff'
                }, {
                    value: 2,
                    color: '#ff0000'
                }]
            }
        });
    </script>
</body>
</html>
